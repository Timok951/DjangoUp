{% extends 'base.html' %}
{% load static %}

{% block title_name %}–í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞{% endblock title_name %}

{% block content %}
<div class="basket-container">
    <h1> –í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞</h1>

    {% if basket %}
        <table>
            <thead>
                <tr>
                    <th>–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</th>
                    <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                    <th>–¢–∏–ø —Ç–æ–≤–∞—Ä–∞</th>
                    <th>–ö–æ–ª-–≤–æ</th>
                    <th>–¶–µ–Ω–∞ –∑–∞ —à—Ç.</th>
                    <th>–°—É–º–º–∞</th>
                    <th>–£–¥–∞–ª–∏—Ç—å</th>
                </tr>
            </thead>
            <tbody>
                {% for item in basket %}
                    {% with item.product as product %}
                        <tr>
                            <td>
                                {% if product.photo %}
                                    <img src="{{ product.photo.url }}" alt="{{ product.name }}" width="80" height="80">
                                {% else %}
                                    <img src="{% static 'main/image/no_photo.jpg' %}" alt="–ù–µ—Ç —Ñ–æ—Ç–æ" width="80" height="80">
                                {% endif %}
                            </td>
                            <td>{{ product.name }}</td>
                            <td>{{ item.type|title }}</td>
                            <td>{{ item.count }} —à—Ç</td>
                            <td>{{ item.price }} ‚ÇΩ</td>
                            <td>{{ item.price|floatformat:2|floatformat:"g" | floatformat:"0" | add:item.count|floatformat:0 }} ‚ÇΩ</td>
                            <td>
                                <a href="{% url 'basket_remove' item.type product.pk %}">–£–¥–∞–ª–∏—Ç—å</a>
                            </td>
                        </tr>
                    {% endwith %}
                {% endfor %}
            </tbody>
        </table>

        <p>
            {{ request.session.basket|default:"–ù–µ—Ç –∫–æ—Ä–∑–∏–Ω—ã –≤ —Å–µ—Å—Å–∏–∏" }}
        </p>

        <div class="basket-summary">
            <p>–í—Å–µ–≥–æ –ø–æ–∑–∏—Ü–∏–π: <strong>{{ basket|length }}</strong></p>
            <p>–û–±—â–∞—è —Å—É–º–º–∞: <strong>{{ basket.get_total_price }} ‚ÇΩ</strong></p>
        </div>

        <div class="basket-actions">
            <a href="{% url 'basket_clear' %}"> –û—á–∏—Å—Ç–∏—Ç—å –∫–æ—Ä–∑–∏–Ω—É</a> |
            <a href="{% url 'all_products' %}"> –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Ç–æ–≤–∞—Ä–∞–º</a> |
            <a href="{% url 'order_open' %}"> –û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</a>
        </div>
    {% else %}
        <p>üõç –í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞. <a href="{% url 'all_products' %}">–ü–µ—Ä–µ–π—Ç–∏ –≤ –∫–∞—Ç–∞–ª–æ–≥</a></p>
    {% endif %}
</div>
{% endblock content %}
